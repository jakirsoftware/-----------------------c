function doGet() {
  const sheet = SpreadsheetApp.openBy.getSheetByName("Setup");
  const ranges = ["D2", "D3", "D4"];
  const values = ranges.map(r => {
    let v = sheet.getRange(r).getValue();
    if (!v) {
      sheet.getRange(r).setValue("none");
      return "none";
    }
    return v.toString().toLowerCase();
  });

  const template = HtmlService.createTemplateFromFile("Index");
  template.setupValues = {
    invoice: values[0],
    cash: values[1],
    bank: values[2]
  };
  return template.evaluate();
}

function updateSetupValue(cell, value) {
  const sheet = SpreadsheetApp.op).getSheetByName("Setup");
  sheet.getRange(cell).setValue(value);
}



<!DOCTYPE html>
<html>
<head>
  <base target="_top">
  <style>
    .content-section {
      display: none;
      padding: 10px;
      margin: 10px 0;
      border: 1px solid #ccc;
      border-radius: 6px;
      background-color: #f0f0f0;
    }
    .controls {
      margin-bottom: 10px;
    }
  </style>
</head>
<body>

  <div class="controls">
    <label><input type="checkbox" id="invoiceToggle"> Show Invoice</label><br>
    <label><input type="checkbox" id="cashToggle"> Show Cash</label><br>
    <label><input type="checkbox" id="bankToggle"> Show Bank</label>
  </div>

  <div id="invoiceContent" class="content-section">
    <strong>Invoice Section</strong><br>
    This is the invoice content.
  </div>

  <div id="cashContent" class="content-section">
    <strong>Cash Section</strong><br>
    This is the cash content.
  </div>

  <div id="bankContent" class="content-section">
    <strong>Bank Section</strong><br>
    This is the bank content.
  </div>

<script>
  function invoiceContent(displayStyle) { 
    document.getElementById("invoiceContent").style.display = displayStyle; 
  }

  function cashContent(displayStyle) { 
    document.getElementById("cashContent").style.display = displayStyle;
  }

  function bankContent(displayStyle) { 
    document.getElementById("bankContent").style.display = displayStyle;
  }

  function updateSection(checkboxId, contentFunction, storageKey) {
    const checkbox = document.getElementById(checkboxId);
    const isChecked = checkbox.checked;
    localStorage.setItem(storageKey, isChecked);
    contentFunction(isChecked ? "block" : "none");
  }

  // Setup on page load
  window.addEventListener("DOMContentLoaded", function() {
    const invoiceChecked = localStorage.getItem("showInvoice") === "true";
    const cashChecked = localStorage.getItem("showCash") === "true";
    const bankChecked = localStorage.getItem("showBank") === "true";

    document.getElementById("invoiceToggle").checked = invoiceChecked;
    document.getElementById("cashToggle").checked = cashChecked;
    document.getElementById("bankToggle").checked = bankChecked;

    invoiceContent(invoiceChecked ? "block" : "none");
    cashContent(cashChecked ? "block" : "none");
    bankContent(bankChecked ? "block" : "none");

    document.getElementById("invoiceToggle").addEventListener("change", function() {
      updateSection("invoiceToggle", invoiceContent, "showInvoice");
    });

    document.getElementById("cashToggle").addEventListener("change", function() {
      updateSection("cashToggle", cashContent, "showCash");
    });

    document.getElementById("bankToggle").addEventListener("change", function() {
      updateSection("bankToggle", bankContent, "showBank");
    });
  });
</script>


</body>
</html>
